//baekjoon_5430
#pragma warning(disable : 4996)
#include <stdio.h>
#define MAX (100)

int Que[MAX*MAX*MAX];
int WP, RP;
char arrstr[400100];

int strlen(char* a)
{
	int i;

	i = 0;
	while (*(a + i++));

	return i - 1;
}

void input()
{
	int i, len, tmpsum;

	scanf("%s", arrstr);
	
	len = strlen(arrstr);
	tmpsum = 0;
	for (i = 0; i < len;i++)
	{
		if ('0' <= arrstr[i] && arrstr[i] <= '9')
		{
			tmpsum *= 10;
			tmpsum += arrstr[i] - '0';
		}
		else if(arrstr[i] == ',' || arrstr[i] == ']')
		{
			if(tmpsum) Que[WP++] = tmpsum;
			tmpsum = 0;
		}
	}
}


void outputQue()
{
	int i;
	putchar('[');
	for (i = RP;i < WP-1;i++)
		printf("%d,", Que[i]);

	printf("%d]",Que[i]);
	putchar('\n');
}

void outputQue_Reverse()
{
	int i;
	putchar('[');
	for (i = WP-1;i >= RP+1;i--)
		printf("%d,", Que[i]);

	printf("%d]", Que[i]);
	putchar('\n');
}

int main(void)
{
	int T;
	int i, tc;
	char func[100100];
	int N;
	int flag, len, error;

	scanf("%d", &T);
	
	for (tc = 0; tc < T;tc++)
	{
		error = flag = WP = RP = 0;

		scanf("%s", func);
		scanf("%d", &N);

		input();

		len = strlen(func);
		for (i = 0; i < len;i++)
		{
			if (func[i] == 'R') flag = !flag;
			else
			{
				if (flag) WP--;
				else RP++;
			}
		}

		if (RP >= WP)
		{
			if (RP == WP) printf("[]\n");
			else printf("error\n");
		}
		else
		{
			if (flag) outputQue_Reverse();
			else outputQue();
		}
	}

	return 0;

}
