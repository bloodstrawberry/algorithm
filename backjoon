바코드란 기계가 판독할 수 있도록 고안된 굵기가 다른 흑백 막대로 조합시켜 만든 코드의 일종으로, 요즘은 거의 모든 상품과 서적에 바코드가 부착되어 있어 물류업체 및 마트, 백화점 등의 유통업체에서 계산, 재고관리 등에 널리 이용되고 있다. 현재는 수많은 종류의 바코드가 존재하지만, 본 문제에서는 우리가 가장 많이 접하는 1차원 선형(막대형) EAN-13 코드에 대해서만 다루기로 한다.

 

EAN-13 은 13자리의 숫자를 표현하는 코드이며, 각 자릿수의 숫자는 3개의 그룹으로 나뉜다. 아래 그림은 EAN-13 바코드의 예시이며 13자리 숫자 8801234567893 를 표현한 것이다.



앞서 언급했듯이 13자리 숫자는 3개의 그룹으로 나뉘는데 맨 첫 자리 숫자 하나가 하나의 그룹(그룹 A), 그 다음 숫자 6개가 또 하나의 그룹(그룹 B), 맨 마지막 숫자 6개가 하나의 그룹(그룹 C) 을 이루며, 숫자를 바코드 막대로 표현하는 방법은 그룹마다 다르다.

 

본 문제에서는 바코드를 0 과 1 로 표현하기로 한다. 즉 바코드의 검은 부분(검게 색칠된 부분)을 1, 흰 부분(색칠되지 않은 부분)을 0 으로 표시하기로 하겠다.

 

바코드는 시작과 끝, 그리고 중간을 알리는 코드가 존재한다. 시작 코드와 끝 코드는 언제나 101 로 표현되며, 중간을 알리는 코드 (그룹 B과 그룹 C 사이의 코드) 는 언제나 01010 으로 표현된다.

 

그룹 C의 표현법이 가장 간단하므로 우선 그룹 C 의 숫자 표현법을 설명한다. 그룹 C의 숫자를 바코드로 표현하면 아래와 같다.

 

[ 그룹 C 의 코드 ] 
숫자 0 : 1110010
숫자 1 : 1100110
숫자 2 : 1101100
숫자 3 : 1000010
숫자 4 : 1011100
숫자 5 : 1001110
숫자 6 : 1010000
숫자 7 : 1000100
숫자 8 : 1001000
숫자 9 : 1110100


그룹 A 는 한자리 숫자로 되어 있으며, 그룹 A의 숫자가 무엇이냐에 따라 그룹 B 의 6개 숫자의 표현법이 달라진다. 그룹 B의 코드 구조는 두 가지(L코드, G코드)가 존재하며 어떤 코드로 표현이 되는지는 그룹 A의 숫자에 따라 달라진다.

 

아래는 그룹 A의 숫자에 따른 그룹 B의 코드 구조를 나타낸 것이다.

 

[ 그룹 A 의 숫자에 따른 그룹 B 의 코드 구조 ]
숫자 0 : LLLLLL
숫자 1 : LLGLGG
숫자 2 : LLGGLG
숫자 3 : LLGGGL
숫자 4 : LGLLGG
숫자 5 : LGGLLG
숫자 6 : LGGGLL
숫자 7 : LGLGLG
숫자 8 : LGLGGL
숫자 9 : LGGLGL

 

예를 들어 위의 예시처럼 그룹 A의 숫자가 8 인 경우 그룹 B의 1번째, 3번째, 6번째 숫자는 L코드로 표현되며, 2번째, 4번째, 5번째 숫자는 G코드로 표현된다.

마지막으로 그룹 B의 숫자 표현법은 아래와 같다.

 

[ 그룹 B 의 코드 ]
숫자 0 : L코드 - 0001101    G코드 - 0100111
숫자 1 : L코드 - 0011001    G코드 - 0110011
숫자 2 : L코드 - 0010011    G코드 - 0011011
숫자 3 : L코드 - 0111101    G코드 - 0100001
숫자 4 : L코드 - 0100011    G코드 - 0011101
숫자 5 : L코드 - 0110001    G코드 - 0111001
숫자 6 : L코드 - 0101111    G코드 - 0000101
숫자 7 : L코드 - 0111011    G코드 - 0010001
숫자 8 : L코드 - 0110111    G코드 - 0001001
숫자 9 : L코드 - 0001011    G코드 - 0010111

 

이 규칙에 의하여, 위의 예시에 있는 숫자 8801234567893 은 바코드로 다음과 같이 표현됨을 알 수 있다.

(시작, 중간, 끝 코드 포함. 가독성을 위해 띄어쓰기와 줄바꿈을 하였으나, 실제 데이터에는 띄어쓰기와 줄바꿈이 없음.)

 

101 0110111 0100111 0011001 0011011 0100001 0100011
01010 1001110 1010000 1000100 1001000 1110100 1000010 101

 

또한 13자리의 마지막 숫자는 체크숫자로서 바코드가 유효한지를 점검할 때 사용된다. 13 번째 자리의 숫자는 다음과 같이 정해진다. 

 

13 번째 숫자는 

 

{홀수자리(1,3,5,7,9,11자리)의 숫자의 합} + {짝수자리(2,4,6,8,10,12자리)의 숫자의 합}×3

 

이 10의 배수가 되게 하기 위해 더해주어야 하는 0 이상의 정수 중 가장 작은 값 이다.

 

위의 예시를 들면
홀수자리의 합은 8+0+2+4+6+8 = 28 이고
짝수자리의 합의 3배는 (8+1+3+5+7+9)×3 = 99 이며
둘을 더한 값 127 이 10 의 배수가 되기 위해서는 최소 3을 더해주어야 하므로 13자리의 숫자는 3 이다. 따라서 이 바코드는 유효하다. 하지만 8801234567890 같은 코드는 체크숫자가 올바르지 않아 유효하지 않음을 알 수 있다.

 

0 과 1로만 이루어진 문자열 (최대 길이 3000) 이 주어진다. 이 문자열 내에서 유효한 EAN-13 바코드가 몇 개 존재하는지를 알아내는 프로그램을 작성하여라.

유의해야 할 것은, 바코드는 뒤집어져 있을 수도 있다는 뜻이다. 즉

 

101 0100001 0010111 0001001 0010001 0000101 0111001
01010 1100010 1000010 1101100 1001100 1110010 1110110 101

 

도 8801234567893 임을 알아내야 한다.


[제한조건]
1. 주어지는 문자열(0, 1 로 이루어짐) 의 길이는 100 이상 3000 이하의 정수이다.
2. 문자열 내의 유효한 바코드에 바로 인접하여 검은 부분(1)이 나오지 않는다. 예를 들어 문자열 내에 아래와 같이 유효한 바코드가 존재한다면 유효한 바코드의 양 끝 옆에 있는 문자 X 는 1 이 될 수 없다는 뜻이다.

 

 문자열 중간 부분에 있는 경우 : ........X[유효한 바코드]X........
 문자열 시작 부분에 있는 경우 : [유효한 바코드]X.................
 문자열 종료 부분에 있는 경우 : .................X[유효한 바코드]

 

3. 어떤 유효한 바코드의 끝 코드가 다른 유효한 바코드의 시작 코드가 되는 등 유효한 바코드가 서로 겹치는 경우는 존재하지 않는다.

 

[입력]
맨 처음 테스트 케이스의 개수 T가 주어지며 그 다음 T개의 테스트 케이스가 주어진다. 각 테스트 케이스는 한 줄로 구성이 되어 있으며 문제에서 설명한 0 과 1 로만 이루어진 문자열이 주어진다.

 

[출력]
테스트 케이스 하나 당 한 줄씩 출력한다. 맨 처음 #x (x 는 테스트케이스 번호, 1부터 시작) 을 출력하고 공백을 하나 둔 후 문자열 내에 존재하는 유효한 바코드의 개수를 출력한다. 그런 다음 공백을 하나 두고 유효한 바코드가 나타내는 13자리 수를 공백으로 구분하여 모두 출력하되 13자리의 수를 하나의 정수로 볼 때 작은 수부터 차례로 출력한다. 중복이 되는 수가 존재할 수 있는데 이 경우에도 중복 횟수만큼 모두 출력해야 함에 유의하라.

 

[입출력 예]
입력과 출력은 지면 관계상 생략한다. sample_input.txt 의 출력을 참고하라.

 

(sample_input.txt 의 출력)
#1 2 8801234567893 8801454502919
#2 2 6937526503743 9501101530003
#3 2 0123456789012 8801234543125
#4 6 0549608274074 1328164677968 3188801750595 4192631597021 6012938515666 8898707915862
#5 9 0286814764981 0477411981035 1822146693811 2949835043524 3314561219182 3645220103871 5777440411547 6828479407489 7386280980496
#6 0
#7 0

 

* 화면에 따라 출력이 테스트 케이스당 여러 줄로 보일 수도 있지만, 실제로는 각 테스트 케이스당 한 줄로 출력해야 함.



7
00101011011101001110011001001101101000010100011010101001110101000010001001001000111010010000101010000101001011101100110010111001101101001110111001010101100010100111010111001001100111001011101101010000
11111111111111111111111111111111111111111111111111111111111111111111111111111111111111010101100010100111011001100110010100111001100101010100111010000101110010111001011100101000010101011111111111111111111111111101010001011010000100100010111001001001101011110101010011101110010100001010001001011100100001010101111111111111111111111111111111111111111111111111111111111111111111111111111111111111111110101000101101001110110011001001101111010011101010101100110100001011100101000100100100011001101010111111
10010000011111110101001001001101010111011011011101001111110010000000001010001101100000010010110001101010110011001101100101110111001010011101110110101010100001110010100100010001001000010100001010101101010101110010011011011001101000010011101011100101010110001010000101101100100110011100101110110101011010101100110011011011001101000010011101011100101010110001010000101101100100110011100101110110101010110100101001100100100110111101010001101100010101111010101000100100100011101001110010110011011011001010
1010110001010001100010110101111000110101101110101011011001000100101110011100101000100101110010101110000101000110101100110011011001011101111010110111010101001110110011010011101010000101000010100001010011011010101101110010111011011100100010100111011101101010111010011001101001110100100010100001101100101011100101010000101011100100010010011101001011101000010101011001001001000100001010011101100010110100010101111100101000100100001010010111001000100100010000101010101011100101000010011001001000110010010111101010101011010100110010010111001001101011110100001011001101010100111011101001000100111001011011001100110101000000001010110011011101101011110011011011000101111010101010111001110010100010010011101001110100001010100001000101001100101101110001001000100101001110011001010101000100100111011100101001110111010010011101010111000010101100110011011001101100100010000101001101101010110111011001001100010100011010111101101000101001100011001001111001010001110110010111110100000101110000101101000111001100010100
1010011101001101101110010100001001110101001110101010011101011110100100011101001100010110100010101001110010101010010101110110010001001000101000110100011010011101010101110011001101100110100111010111001000100101010011010101011000101011001100010010010111001110100001010010001010101100010100110011101101111010111011011001001010100111011111111001010111101000100101011110011011011011101001110101011101001001000111001010111001110100101000010100111011111110111010100101110001001001110100100010100111001110101010110100011011101011100100100011011001110110101011101010110010100101011001101100110001001010000100101110000101010101010000101110010011001101100110010011101101010011110111001100001010110011001000100010010100001010011101100110101010110001101100110110010011101100010111101010100111101001010111010101111010011001001110101110010000101001100101010110110011001101110100110011010010001101100101001100001011010100101010001101110110111011010001100110010011001010101110100100100011001101110010100001010011101010
0110011111011001010101011001101011101000100101111011011000001011010000111000110110110001001000010100010111111000110000101000110101011110011011101101011111101110011100111100111011111000100100011000011111100010010100000101101110011011000000111011010111101101110100100111100101001010000101000110111110110101000101110011100000001011110111100111101011001100000011000011010000011100110000011110101101001110111010100110110011110000111111100101100011010000010101111011110110010100001101100110001110010101001100111101000110111001010001010101001110000110110111011101110001101111111110000000110100100101100111101011101101100000100000110001101101101110110000101100101011110001111000101010011011010101011001010110001001011100101001100111011011000111000011100100100001001100101111110000110010000001001011101000111111000110111001101110011101101001010001110011101001111100110000101011110001000111110011000011000000110100011001101110110011001010000101011110100110101101101100110001010001011101100110001011000001000010
1010111011001001101101110110001001110101101110101011101001101100100100010100001001000111001010101110000111111100010100110110001001001000100010010010111001011101010110110010111001110100111010010011101001000101000000100101001000101001100101000010001101010111101011110100001010101011100111001010010001000010100010010111001010011101001111000001010101111010011101110010011011000110101110110101010000101010000100100010001001110100100111010101011100100000100010100010010100111001101100101110011011001110101010110110010001001000110111011011100101110110101010010011110110000101011000100011010110011010001101001110100111010101001110100010010111001000100100010011011001010101111011111010001010001001001011101001110000101001011100010010101010001001101000100011010000101001000110010010100001000100001011010100110010001011001100101011110001101001100101010101110010000101011100100010011101001101100101010100001000111010101001011100101110100111001101100111010010111010101100010100011010011101000100111001011010001010
